<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>engine.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/core.browser.html">core.browser</a></li>
            
                <li><a href="../classes/core.entity.html">core.entity</a></li>
            
                <li><a href="../classes/core.file.html">core.file</a></li>
            
                <li><a href="../classes/core.ready.html">core.ready</a></li>
            
                <li><a href="../classes/core.support.html">core.support</a></li>
            
                <li><a href="../classes/core.system.html">core.system</a></li>
            
                <li><a href="../classes/entity.base.html">entity.base</a></li>
            
                <li><a href="../classes/entity.gfx.html">entity.gfx</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/core.html">core</a></li>
            
                <li><a href="../modules/entity.html">entity</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: engine.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">


(function(undefined)
{


	/**
	 * @namespace 
	 * @name core
	 */

	/**
	 *
	 *
	 */
	var core = 
	{
		version: &#x27;0.1&#x27;,

		data:
		{

		},
	};

	core.isReady = false;
	core.readyList = [];

	/**
	 * Add a function call to the ready event of the core or execute the ready state
	 * @function 
	 * @name ready
	 * @memberof core
	 * @exemple 
	 * @return {boolean} true on success
	 */


	core.ready = function(fn)
	{
		if (core.isFunction(fn))
		{
			if (core.isReady) fn();
			else core.readyList.push(fn);
			return true;
		}
		for (var t=0; t&lt;core.readyList.length; t++) core.readyList[t]();
		core.readyList = [];
		core.isReady = true;
		return true;
	};

	///////////////////////////////////////////////////////////////////////////////////////////////////////
	// System
	///////////////////////////////////////////////////////////////////////////////////////////////////////

	/**
	 * @namespace 
	 * @name core.file
	 */

	/**
	 * Load a js script file
	 * @function 
	 * @name loadjs
	 * @memberof core.system
	 * @param list {array|string} Array of the script files to load
	 * @param complete {function} Called when the load of the whole list is complete
	 * @param error {function} Called when a script load throw an error
	 * @param progress {function} Called on the progress of each script load
	 */
	core.loadjs = function(list, complete, error, progress)
	{
		if (!list) return;
		if (core.isString(list)) list = [list];
		complete = complete || function() {};
		error = error || function() {};
		progress = progress || function() {};

		if (list.length==0)
		{
			complete.done = true;
			complete();
		}
		var max = list.length;
		var count = 0;
		for (var t=0; t&lt;max; t++)
		{
			var s = document.createElement(&#x27;script&#x27;);
			var yp = core;
			s.src = list[t];
			s.async = true;
			delete s.crossOrigin;
			s.onreadystatechange = s.onload = function(e) 
			{
				progress(e);
				var state = s.readyState || e.type;
				if (!complete.done &amp;&amp; (/load|loaded|complete/i.test(state) || state===4))
				{
					count++;
					if (max==count)
					{
						complete.done = true;
						complete(e);
					}
				}
			};

			(function()
			{
				var src = list[t];
				s.onerror = s.onError = function(e)
				{
					if (core.options[&#x27;debug&#x27;]) console.error(&#x27;Could not load the script &quot;&#x27;+src+&#x27;&quot;&#x27;)
					e.src = src;
					error(e);
				};
			})();

			document.getElementsByTagName(&#x27;head&#x27;)[0].appendChild(s);            
		}
	};

	core.loadcss = function(list, complete, error, progress)
	{
		if (!list) return;
		if (core.isString(list)) list = [list];
		complete = complete || function() {};
		error = error || function() {};
		progress = progress || function() {};

		if (list.length==0)
		{
			complete.done = true;
			complete();
		}
		var max = list.length;
		var count = 0;
		for (var t=0; t&lt;max; t++)
		{
			var s = document.createElement(&#x27;link&#x27;);
			s.type = &#x27;text/css&#x27;;
			s.rel   = &#x27;stylesheet&#x27;;
			s.href = list[t];
			s.async = true;
			s.onprogress = function(e) 
			{
				e.src = s.href;
				progress(e);
			};
			s.onreadystatechange = s.onload = function(e) 
			{
				var state = s.readyState || e.type;
				if (!complete.done &amp;&amp; (/load|loaded|complete/i.test(state) || state===4)) 
				{
					count++;
					if (max==count)
					{
						complete.done = true;
						e.src = s.href;
						complete(e);
					}
				}
			};

			(function()
			{
				var src = list[t];
				s.onerror = s.onError = function(e)
				{
					e.src = src;
					error(e);
				};
			})();

			document.getElementsByTagName(&#x27;head&#x27;)[0].appendChild(s);            
		}
	};

	core.clone = function (obj) 
	{
		var count = 1;
		var temp = new obj.constructor();
		for (n in obj) temp[n] = obj[n];
		return temp;
	};

	
	core.unique = function (arr)
	{
		var o={},
			i,
			l=arr.length,
			r=[];
		for (i=0;i&lt;l;i++) o[arr[i]]=arr[i];
		for(i in o)r.push(o[i]);
		return r;
	};

	core.getExtension = function (str)
	{
		var ext = str.split(&#x27;.&#x27;).pop();
		if (ext == str) return &#x27;&#x27;;
		return ext;     
	};
	
	core.getFilename = function (str)
	{
		return str.split(&#x27;/&#x27;).pop();
	};
	
	core.getDir = function (str)
	{
		if (str.lastIndexOf(&quot;/&quot;)==-1) return &#x27;&#x27;;
		return str.substring(0, this.lastIndexOf(&quot;/&quot;) + 1);
	};
	
	core.getNoExtension = function (str)
	{
		var filename = core.getFilename(str);
		if (filename.lastIndexOf(&quot;.&quot;)==-1) return filename;
		return filename.substring(0, filename.lastIndexOf(&quot;.&quot;));
	}
	
	core.isInt = function (value)
	{
		if (core.isString(value)) return false;
		if ((parseFloat(value) == parseInt(value)) &amp;&amp; !isNaN(value)) return true;
		return false;
	}
	
	core.isArray = function (value) 
	{
		return Object.prototype.toString.call(value) === &#x27;[object Array]&#x27;;
	}
	
	core.isUndefined = function (value) 
	{
		return value === undefined;
	}
	
	core.isString = function (value)
	{
		return typeof value == &#x27;string&#x27;;
	}
	
	core.isFunction = function (fn)
	{
		return fn &amp;&amp; {}.toString.call(fn) === &#x27;[object Function]&#x27;;
	}

	core.pLength = function (object) 
	{
		var length = 0;
		for( var key in object ) if (object.hasOwnProperty(key)) ++length;
		return length;
	};
	
	/**
	 *
	 */
	core.dump = function (obj, string, detailedArray) 
	{
		string = string || &#x27;&#x27;;
		detailedArray = detailedArray || true;
		console.log(&#x27;Object dump: &#x27;+string);
		var count = 1;
		for (n in obj)
		{
			if (obj[n] === null) console.log(&#x27;  - &#x27;+n+&#x27; : null&#x27;);
			else if (typeof obj[n] === &#x27;undefined&#x27;) console.log(&#x27; - &#x27;+n+&#x27; = undefined&#x27;);
			else if (typeof obj[n] === &#x27;boolean&#x27;) console.log(&#x27; - &#x27;+n+&#x27; = &quot;&#x27;+obj[n]+&#x27;&quot; (boolean)&#x27;);
			else if (typeof obj[n] === &#x27;number&#x27;) console.log(&#x27; - &#x27;+n+&#x27; = &#x27;+obj[n]+&#x27; (integer)&#x27;);
			else if (typeof obj[n] === &#x27;function&#x27;) console.log(&#x27; - &#x27;+n+&#x27; (function)&#x27;);
			else if (core.isString(obj[n])) console.log(&#x27; - &#x27;+n+&#x27; = &quot;&#x27;+obj[n]+&#x27;&quot; (string)&#x27;);
			else if (core.isArray(obj[n]))
			{
				var str = &#x27;&#x27;;
				if (detailedArray) for (var t=0; t&lt;obj[n].length; t++)
				{
					if (t&gt;0) str += &#x27;, &#x27;;
					str += &#x27;[&#x27;+t+&#x27;] &#x27;;
					if (obj[n][t] === null) str += &#x27;null&#x27;;
					else if (typeof obj[n][t] === &#x27;undefined&#x27;) str += &#x27;undefined&#x27;;
					else if (typeof obj[n][t] === &#x27;boolean&#x27;) str += &#x27;&quot;&#x27;+obj[n][t]+&#x27;&quot; (boolean)&#x27;;
					else if (typeof obj[n][t] === &#x27;number&#x27;) str += obj[n][t]+&#x27; (integer)&#x27;;
					else if (typeof obj[n][t] === &#x27;function&#x27;) str += &#x27;function&#x27;;
					else if (core.isArray(obj[n][t])) str += &#x27;Array (&#x27;+obj[n][t].length+&#x27;)&#x27;;
					else str += obj[n][t];
					if (t&gt;9)
					{
						str += &#x27; ...&#x27;;
						break;
					}
				}
				if (str==&#x27;&#x27;) console.log(&#x27; - &#x27;+n+&#x27; (array), length &#x27;+obj[n].length+&#x27;&#x27;);
				else console.log(&#x27; - &#x27;+n+&#x27; (array), length &#x27;+obj[n].length+&#x27;, content: &#x27;+str);
			} else console.log(&#x27; - &#x27;+n+&#x27; : &quot;&#x27;+obj[n]+&#x27;&quot; (&#x27;+(typeof obj[n])+&#x27;)&#x27;);
		}
		
	};




	function yploader (options, context)
	{
		if (!options) return core;
		options = options || {};
		context = context || document;

		//var modules = [&#x27;base&#x27;, &#x27;image&#x27;, &#x27;sound&#x27;]; // yespix common modules
		var modules = []; // yespix common modules

		options[&#x27;namespace&#x27;] = options[&#x27;namespace&#x27;] || &#x27;yespix&#x27;;
		options[&#x27;dir_resources&#x27;] = options[&#x27;dir_resources&#x27;] || &#x27;resources/&#x27;;
		options[&#x27;dir_engine&#x27;] = options[&#x27;dir_engine&#x27;] || &#x27;yespix/&#x27;;
		options[&#x27;dir_modules&#x27;] = options[&#x27;dir_modules&#x27;] || &#x27;yespix/modules/&#x27;;
		
		options[&#x27;modules&#x27;] = core.unique(modules.concat(options[&#x27;modules&#x27;] || []));

		options[&#x27;init&#x27;] = options[&#x27;init&#x27;] || function() {};

		for (var t=0; t&lt;options[&#x27;modules&#x27;].length; t++)
		{
			if (!/^http(s)?\:\/\//i.test(options[&#x27;modules&#x27;][t]))
			{
				options[&#x27;modules&#x27;][t] = options[&#x27;dir_modules&#x27;]+options[&#x27;modules&#x27;][t];
				if (!/\.js$/i.test(options[&#x27;modules&#x27;][t])) options[&#x27;modules&#x27;][t] =options[&#x27;modules&#x27;][t]+&#x27;.js&#x27;;
			}
			//console.log(&#x27;script &#x27;+options[&#x27;modules&#x27;][t]);
		}

		core.options = options;
		window[options[&#x27;namespace&#x27;]] = core;

		(function()
		{
			core.loadjs(options[&#x27;modules&#x27;], function()
			{
				options[&#x27;init&#x27;]();
				core.ready();
			});
		})();
		return core;
	}

	// Expose yploader
	window.yploader = yploader;






	/**
	 *
	 * Media support detection
	 * Function yespix.support(type) return true if the requested audio or video is supported
	 *
	 * @use support(&#x27;audio&#x27;) detects if audio is supported
	 * @use support(&#x27;.mp3&#x27;) detects if mp3 extension is supported, assuming &quot;.mp3&quot; file has an audio/mpeg mimetype
	 * @use support(&#x27;audio/wav&#x27;) detects if mimetype audio/wav is supported
	 * @use support(&#x27;audio/ogg; codecs=&quot;vorbis&quot;&#x27;) detects if mimetype audio/ogg is supported with codec Vorbis. Note: Some browsers are completely ignoring the codecs and always return the same thing
	 *
	 */
	core.support = function(type)
	{
		if (!type) return null;
		var types = type.split(&#x27;/&#x27;);

		// type can be a media type or an extension
		if (types.length==1)
		{
			// check if the type is a media type
			if (this.data.support.types[type])
			{
				if (!this.data.support.elements[type])
				{
					this.data.support.elements[type] = document.createElement(type);
				}
				return !!this.data.support.elements[type].canPlayType;
			}
			// check if the type is an extension
			if (this.data.support.extensions[type])
			{
				type = this.data.support.extensions[type];
				types = type.split(&#x27;/&#x27;);
			} else return null;
		}


		if (this.data.support[types[0]]!=undefined &amp;&amp; this.data.support[types[0]][types[1]]!=undefined) return this.data.support[types[0]][types[1]];

		// create element if needed
		if (this.data.support.elements[types[0]]==undefined)
		{
			//console.log(&#x27;type=&#x27;+type+&#x27;, types[0]=&#x27;+types[0]+&#x27;, types[1]=&#x27;+types[1]);
			this.data.support.elements[types[0]] = document.createElement(types[0]);
			if (!!this.data.support.elements[types[0]]==false) this.data.support.elements[types[0]]=false;
		}

		var e = this.data.support.elements[types[0]];
		if (!e || !!e.canPlayType==false) return false;

		var str = e.canPlayType(type);
		if (str.toLowerCase()==&#x27;no&#x27; || str==&#x27;&#x27;) this.data.support[types[0]][types[1]]=false;
		else this.data.support[types[0]][types[1]]=true;

		return this.data.support[types[0]][types[1]];
	};

	core.data.support =
	{
		types:
		{
			&#x27;audio&#x27;: true,
			&#x27;video&#x27;: true,
		},
		extensions: 
		{
			&#x27;.3gp&#x27;: &#x27;audio/3gpp&#x27;,
			&#x27;.ac3&#x27;: &#x27;audio/wav&#x27;,
			&#x27;.avi&#x27;: &#x27;video/avi&#x27;,
			&#x27;.kar&#x27;: &#x27;audio/midi&#x27;,
			&#x27;.mid&#x27;: &#x27;audio/midi&#x27;,
			&#x27;.m4a&#x27;: &#x27;audio/x-m4a&#x27;,
			&#x27;.mov&#x27;: &#x27;video/quicktime&#x27;,
			&#x27;.mp3&#x27;: &#x27;audio/mpeg&#x27;,
			&#x27;.mp4&#x27;: &#x27;video/mp4&#x27;,
			&#x27;.mpa&#x27;: &#x27;audio/mpeg&#x27;,
			&#x27;.mpg&#x27;: &#x27;video/mpeg&#x27;,
			&#x27;.webm&#x27;: &#x27;video/webm&#x27;,
		},
		audio: {},
		video: {},
		elements: {},
	};





	core.isMobile = function()
	{
		if (!this.data.browser.initiated) this.browser();
		return this.data.browser.mobile;
	};
	
	core.browser = function()
	{
		var core = this;

		if (!core.data.browser.name)
		{
			function findBrowser(str)
			{
				var data = core.data.browser.browserList;
				for (var i=0;i&lt;data.length;i++)
				{
					if (str.indexOf(data[i].subString) != -1)
					{
						core.data.browser.found = data[i];
						return data[i].identity;
					}
				}
			}

			function findOs(str)
			{
				var data = core.data.browser.osList;
				for (var i=0;i&lt;data.length;i++)
				{
					if (str.indexOf(data[i].subString) != -1)
					{
						core.data.browser.found = data[i];
						return data[i].identity;
					}
				}
			}

			function findVersion (str) 
			{
				if (!core.data.browser.found) return;
				var find = core.data.browser.found.version || core.data.browser.infos.name;
				var index = str.indexOf(find);
				if (index == -1) return;
				return str.substring(index+find.length+1).split(&#x27; &#x27;).shift();
			}

			function findMobile (str) 
			{
				if (!core.data.browser.found) return;
				return /iPhone|iPod|Android|opera mini|blackberry|palm os|palm| Mobile|hiptop|avantgo|plucker|xiino|blazer|elaine|iris|3g_t|windows ce|opera mobi| smartphone;|;iemobile/i.test(str);
			}

			core.data.browser.infos.initiated = true;
			core.data.browser.infos.name = findBrowser(navigator.userAgent) || findBrowser(navigator.vendor) || &quot;Unknown browser&quot;;
			core.data.browser.infos.version = findVersion(navigator.userAgent) || findVersion(navigator.appVersion) || &quot;Unknown version&quot;;
			if (core.data.browser.infos.version!=&quot;Unknown version&quot;)
			{
				var version = core.data.browser.infos.version;
				core.data.browser.infos.versionMajor = parseInt(version);
				if (version.indexOf(&quot;.&quot;) != -1) core.data.browser.infos.versionMinor = version.substring(version.indexOf(&quot;.&quot;)+1);
				else core.data.browser.infos.versionMinor = &#x27;&#x27;;
			}
			core.data.browser.infos.os = findOs(navigator.platform) || findOs(navigator.userAgent) || &quot;Unknown OS&quot;;
			core.data.browser.infos.mobile = findMobile(navigator.userAgent) || findMobile(navigator.platform) || false;
		}

		return core.data.browser.infos;
	};

	core.data.browser =
	{
		infos:
		{
			name: null,
			version: null,
			os: null,
			mobile: null,
			initiated: false,
		},
		browserList:
		[
			{
				subString: &quot;Chrome&quot;,
				identity: &quot;Chrome&quot;
			},
			{
				subString: &quot;OmniWeb&quot;,
				identity: &quot;OmniWeb&quot;,
				version: &quot;OmniWeb/&quot;,
			},
			{
				subString: &quot;Apple&quot;,
				identity: &quot;Safari&quot;,
				version: &quot;Version&quot;
			},
			{
				subString: &quot;Opera&quot;,
				identity: &quot;Opera&quot;,
				version: &quot;Version&quot;,
			},
			{
				subString: &quot;iCab&quot;,
				identity: &quot;iCab&quot;,
			},
			{
				subString: &quot;KDE&quot;,
				identity: &quot;Konqueror&quot;,
			},
			{
				subString: &quot;Firefox&quot;,
				identity: &quot;Firefox&quot;,
			},
			{
				subString: &quot;Camino&quot;,
				identity: &quot;Camino&quot;,
			},
			{   
				subString: &quot;Netscape&quot;,
				identity: &quot;Netscape&quot;,
			},
			{
				subString: &quot;MSIE&quot;,
				identity: &quot;Explorer&quot;,
				version: &quot;MSIE&quot;,
			},
			{
				subString: &quot;Gecko&quot;,
				identity: &quot;Mozilla&quot;,
				version: &quot;rv&quot;,
			},
			{   
				subString: &quot;Mozilla&quot;,
				identity: &quot;Netscape&quot;,
				version: &quot;Mozilla&quot;,
			}
		],
		osList : 
		[
			{
				subString: &quot;Win&quot;,
				identity: &quot;Windows&quot;,
			},
			{
				subString: &quot;Mac&quot;,
				identity: &quot;Mac&quot;,
			},
			{
				subString: &quot;iPhone&quot;,
				identity: &quot;iPhone/iPod&quot;,
			},
			{
				subString: &quot;Linux&quot;,
				identity: &quot;Linux&quot;,
			}
		],


	};

	
})();
    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
