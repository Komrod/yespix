<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Box2D Javascript Fun : 00 : Most Basic Box2D Example</title>
        <script src="../build/yespix.js"></script>
        <script src="engines/box2d.js"></script>
    </head>
    <body>
<script>


    // init yespix engine
    yespix();
    var manager = new GfxManager(true);
    manager.setEngine(new EngineBox2d());

    // create ground
    manager.engine.createRect(0, 400, 640, 10, true);
    for (var t=0; t<10; t++) {
        manager.engine.createRect(yespix.randInt(1,600), yespix.randInt(100,400), yespix.randInt(10,50), yespix.randInt(10,50), true);
    }

    for (var t=0; t<1000; t++) {
        // create entity
        var rect = new yespix.class.image({
            image: 'unit/image/zardoz.png',
            position: {
                x: yespix.randInt(1,600), 
                y: yespix.randInt(-10300,300), 
                snapToPixel: true,
            }, 
            aspect: {
                width: 20,
                height: 20
            },
        });
        //rect.set({aspect: {width: 20, height: 20}, image: {autoSize: false}});

        // add to manager
        manager.add(rect);

        rect.collision = new Collision({offsetX: 2, width: 16, fixedRotation: false}, rect);
    }

    manager.load();

    // create the loop
    var loop = new Loop(100);

    /*
    manager.engine.world.Step(10, 100, 100);
    manager.applyPhysics(); // apply position from physics engine
    manager.engine.world.DrawDebugData(); // draw debug
    manager.draw(); // draw entities
    */
   
    
    // register functions
    loop.register(
        // frame function
        function(loop, time) { 
            manager.applyPhysics(); // apply position from physics engine
            manager.clear(); // clear canvas
            manager.engine.world.DrawDebugData(); // draw debug
            //manager.draw(); // draw entities
            //manager.engine.world.ClearForces();
        }, 
        // step function
        function(loop, time) {  
            manager.engine.world.Step(time/1000, 100, 100);
        }
    ).start();
    
    
    </script>
    
  </body>
</html>