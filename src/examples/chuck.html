<!DOCTYPE html>
<html>
<head>
	<script type="text/javascript" src="../engine/yespix.js"></script>
	<style>

	canvas, body {
		margin: 0;
		padding: 0;
		border: 0;
		overflow: hidden;
	}

	</style>
</head>
<body>
<script type="text/javascript">

	var yp = yespix({canvas: {width: '100%', height: '100%'}, fps: 60});
	
	yp.define('chuck', 'player2w',
	{
		images: 'chuck/player.png',
		pixelSize: 3,
		colOffsetX: 8,
		colOffsetY: 10,
		colWidth: 14,
		colHeight: 29,
		//debug: true,
		actorSpeed: 1,
		actorSpeedJump: 10,
		playerSpawnOnFloor: true,

		snapToPixel: true,

		init: function()
		{
			yespix.on('animFrame', function(e)
			{
				//console.log('e.name = '+e.name+', e.frame = '+e.frame);
				if (e.frame==3)
				{
					if (e.name=='punch1left' || e.name=='punch1right')
					{
						this.isAttacking = false;
						this.actorAnims.attackleft = 'punch2left';
						this.actorAnims.attackright = 'punch2right';
					} else if (e.name=='punch2left' || e.name=='punch2right')
					{
						this.isAttacking = false;
						this.actorAnims.attackleft = 'punch1left';
						this.actorAnims.attackright = 'punch1right';
					}
				}
				if (this.isJumping)
				{
					//console.log('animSelected = '+this.animSelected+', animFrame = '+animFrame+', ')
				}
			}, this, this);
		},
		animDefault:
		{
			width: 32,
			height: 40,
			name: 'idleright',
			duration: 100,
		},
		actorAnims: {
			
			'idleright': 'idleright',
			'idleleft': 'idleleft',

			'walkright': 'walkright',
			'walkleft': 'walkleft',

			'lookup': 'lookup',
			'lookdown': 'lookdown',
			
			'jumpleft': 'jumpleft',
			'jumpright': 'jumpright',
			
			'airleft': 'airleft',
			'airright': 'airright',
			
			'attackleft': 'punch1left',
			'attackright': 'punch1right',
		},
		anims:
		{
			idleright:
			{
				length: 7,
			},
			walkright:
			{
				from: 24,
				length: 8,
			},
			punch1right:
			{
				from: 8,
				length: 5,
				duration: 50,
			},
			punch2right:
			{
				from: 16,
				length: 5,
				duration: 50,
			},
			jumpright:
			{
				from: 32,
				length: 3,
			},
			airright:
			{
				from: 34,
				length: 2,
			},
			landright:
			{
				from: 32,
				length: 1,
			},

			idleleft:
			{
				extendsFrom: 'idleright',
				flipX: true,
			},
			walkleft:
			{
				extendsFrom: 'walkright',
				flipX: true,
			},
			punch1left:
			{
				extendsFrom: 'punch1right',
				flipX: true,
			},
			punch2left:
			{
				extendsFrom: 'punch2right',
				flipX: true,
			},
			jumpleft:
			{
				extendsFrom: 'jumpright',
				flipX: true,
			},
			airleft:
			{
				extendsFrom: 'airright',
				flipX: true,
			},
			landleft:
			{
				extendsFrom: 'landright',
				flipX: true,
			},
		}
	});
	


    
	yp.gravity = { y: 22 };

	var mylevel = yp.spawn('level', {name: 'level test', x: 0, y: 0, pixelSize: 1}).load('chuck/test.json');
	var mychuck = yp.spawn('chuck',{ name: 'chuck', x: 500, y: 50, z: 1000});
	
	for (var t=0; t<1000; t++) {

		yp.spawn('circle', {
			x: yp.randInt(0, 3000), 
			y: yp.randInt(0, 600), 
			circleRadius:15,
            lineColor: '',
            fillColor: '#19D1FF'}).setParent(mylevel);
	}
	
	yp.spawn('fps', {x: 10, y: 20});

	mylevel.follow(mychuck, {resetOnStart: true});


</script>
</body>
</html>
